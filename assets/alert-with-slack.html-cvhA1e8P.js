import{_ as e}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as t,c as a,d as n}from"./app-d7bHIUBF.js";const i="/prometheus-book/assets/slack-overview-GSbIT89w.png",l="/prometheus-book/assets/slack-create-channel-JobWOOTz.png",s="/prometheus-book/assets/slack-channel-NwtiGK8o.png",o="/prometheus-book/assets/add-incomming-webhooks-mGpS0U4H.png",r="/prometheus-book/assets/incomming-webhooks-setting-6ZDga11R.png",d="/prometheus-book/assets/slack-receiver-message-uaUBfGLB.png",c="/prometheus-book/assets/custom-slack-message-VtUX6lbo.png",g="/prometheus-book/assets/slack_alert_message-1ZyOo-4-.png",m="/prometheus-book/assets/slack_resolved_message-8LJncUvD.png",u={},p=n('<h1 id="ä¸slacké›†æˆ" tabindex="-1"><a class="header-anchor" href="#ä¸slacké›†æˆ" aria-hidden="true">#</a> ä¸Slacké›†æˆ</h1><p>Slackæ˜¯éå¸¸æµè¡Œçš„å›¢é˜Ÿæ²Ÿé€šåº”ç”¨ï¼Œæä¾›ç¾¤ç»„èŠå¤©å’Œç›´æ¥æ¶ˆæ¯å‘é€åŠŸèƒ½ï¼Œæ”¯æŒç§»åŠ¨ç«¯ï¼ŒWeb å’Œæ¡Œé¢å¹³å°ã€‚åœ¨å›½å¤–æœ‰å¤§é‡çš„ITå›¢é˜Ÿä½¿ç”¨Slackä½œä¸ºå›¢é˜Ÿåä½œå¹³å°ã€‚åŒæ—¶å…¶æä¾›äº†å¼ºå¤§çš„é›†æˆèƒ½åŠ›ï¼Œåœ¨Slackçš„åŸºç¡€ä¸Šä¹Ÿè¡ç”Ÿå‡ºäº†å¤§é‡çš„ChatOpsç›¸å…³çš„æŠ€æœ¯å®è·µã€‚è¿™éƒ¨åˆ†å°†ä»‹ç»å¦‚ä½•å°†Slacké›†æˆåˆ°Alertmanagerä¸­ã€‚</p><h2 id="è®¤è¯†slack" tabindex="-1"><a class="header-anchor" href="#è®¤è¯†slack" aria-hidden="true">#</a> è®¤è¯†Slack</h2><figure><img src="'+i+'" alt="Slack" tabindex="0" loading="lazy"><figcaption>Slack</figcaption></figure><p>Slackä½œä¸ºä¸€æ¬¾å³æ—¶é€šè®¯å·¥å…·ï¼Œåä½œæ²Ÿé€šä¸»è¦é€šè¿‡Channelï¼ˆå¹³å°ï¼‰æ¥å®Œæˆï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¼ä¸šä¸­æ ¹æ®ç”¨é€”æ·»åŠ å¤šä¸ªChannelï¼Œå¹¶ä¸”é€šè¿‡Channelæ¥é›†æˆå„ç§ç¬¬ä¸‰æ–¹å·¥å…·ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºç›‘æ§å»ºç«‹ä¸€ä¸ªå•ç‹¬çš„Channelç”¨äºæ¥æ”¶å„ç§ç›‘æ§ä¿¡æ¯ï¼š</p><figure><img src="'+l+'" alt="åˆ›å»ºChannel" tabindex="0" loading="lazy"><figcaption>åˆ›å»ºChannel</figcaption></figure><p>é€šè¿‡ä¸€ä¸ªç‹¬ç«‹çš„Channleå¯ä»¥å‡å°‘ä¿¡æ¯å¯¹ç”¨æˆ·å·¥ä½œçš„å¹²æ‰°ï¼Œå¹¶ä¸”å°†ç›¸å…³ä¿¡æ¯èšåˆåœ¨ä¸€èµ·ï¼š</p><figure><img src="'+s+'" alt="Monitoring" tabindex="0" loading="lazy"><figcaption>Monitoring</figcaption></figure><p>Slackçš„å¼ºå¤§ä¹‹å¤„åœ¨äºåœ¨Channelä¸­æ·»åŠ å„ç§ç¬¬ä¸‰æ–¹æœåŠ¡çš„é›†æˆï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥åŸºäºSlackå¼€å‘è‡ªå·±çš„èŠå¤©æœºå™¨äººæ¥å®ç°ä¸€äº›æ›´é«˜çº§çš„èƒ½åŠ›ï¼Œä¾‹å¦‚è‡ªåŠ¨åŒ–è¿ç»´ï¼Œæé«˜å¼€å‘æ•ˆç‡ç­‰ã€‚</p><h2 id="æ·»åŠ åº”ç”¨-incomming-webhooks" tabindex="-1"><a class="header-anchor" href="#æ·»åŠ åº”ç”¨-incomming-webhooks" aria-hidden="true">#</a> æ·»åŠ åº”ç”¨ï¼šIncomming Webhooks</h2><p>ä¸ºäº†èƒ½å¤Ÿåœ¨Monitoringä¸­æ¥æ”¶æ¥è‡ªAlertmanagerçš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Channelçš„è®¾ç½®é€‰é¡¹ä¸­ä½¿ç”¨&quot;Add an App&quot;ä¸ºMonitoring channelæ·»åŠ ä¸€ä¸ªåä¸º<code>Incoming WebHooks</code>çš„åº”ç”¨ï¼š</p><figure><img src="'+o+'" alt="æ·»åŠ Incomming Webhooks" tabindex="0" loading="lazy"><figcaption>æ·»åŠ Incomming Webhooks</figcaption></figure><p>æ·»åŠ æˆåŠŸåSlackä¼šæ˜¾ç¤º<code>Incoming WebHooks</code>é…ç½®å’Œä½¿ç”¨æ–¹å¼ï¼š</p><figure><img src="'+r+`" alt="Incomming Webhhooké…ç½®" tabindex="0" loading="lazy"><figcaption>Incomming Webhhooké…ç½®</figcaption></figure><p>Incomming Webhookçš„å·¥ä½œæ–¹å¼å¾ˆç®€å•ï¼ŒSlackä¸ºå½“å‰Channelåˆ›å»ºäº†ä¸€ä¸ªç”¨äºæ¥æ”¶æ¶ˆæ¯çš„APIåœ°å€ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>https://hooks.slack.com/services/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
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç”¨æˆ·åªéœ€è¦ä½¿ç”¨Postæ–¹å¼å‘Channelå‘é€éœ€è¦é€šçŸ¥çš„æ¶ˆæ¯å³å¯ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­é€šè¿‡curlæ¨¡æ‹Ÿä¸€æ¬¡æ¶ˆæ¯é€šçŸ¥ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -d &quot;payload={&#39;text&#39;: &#39;This is a line of text in a channel.\\nAnd this is another line of text.&#39;}&quot; https://hooks.slack.com/services/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
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åœ¨ç½‘ç»œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåœ¨Channelä¸­ä¼šæ˜¾ç¤ºæ–°çš„é€šçŸ¥ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="`+d+`" alt="æµ‹è¯•æ¶ˆæ¯" tabindex="0" loading="lazy"><figcaption>æµ‹è¯•æ¶ˆæ¯</figcaption></figure><p>é™¤äº†å‘é€çº¯æ–‡æœ¬ä»¥å¤–ï¼Œslackè¿˜æ”¯æŒåœ¨æ–‡æœ¬å†…å®¹ä¸­æ·»åŠ é“¾æ¥ï¼Œä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>payload={&quot;text&quot;: &quot;A very important thing has occurred! &lt;https://alert-system.com/alerts/1234|Click here&gt; for details!&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ­¤æ—¶æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸­å»ºè¾‰åŒ…å«ä¸€ä¸ªå¯ç‚¹å‡»çš„è¶…é“¾æ¥åœ°å€ã€‚é™¤äº†payloadä»¥å¤–ï¼ŒIncomming Webhhookè¿˜æ”¯æŒä¸€äº›å…¶ä»–çš„å‚æ•°ï¼š</p><table><thead><tr><th>å‚æ•°</th><th>ä½œç”¨</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>username</td><td>è®¾ç½®å½“å‰èŠå¤©æœºå™¨äººçš„åç§°</td><td>webhookbot</td></tr><tr><td>icon_url</td><td>å½“å‰èŠå¤©æœºå™¨äººçš„å¤´åƒåœ°å€</td><td>https://slack.com/img/icons/app-57.png</td></tr><tr><td>icon_emoji</td><td>ä½¿ç”¨emojiä½œä¸ºèŠå¤©æœºå™¨äººçš„å¤´åƒ</td><td>ğŸ‘»</td></tr><tr><td>channel</td><td>æ¶ˆæ¯å‘é€çš„ç›®æ ‡channel, éœ€è¦ç›´æ¥å‘ç»™ç‰¹å®šç”¨æˆ·æ—¶ä½¿ç”¨@usernameå³å¯</td><td>#monitoring æˆ–è€… @username</td></tr></tbody></table><p>ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸Šå‚æ•°å‘é€ä¸€æ¡æ›´æœ‰è¶£çš„æ¶ˆæ¯ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>curl -X POST --data-urlencode &quot;payload={&#39;channel&#39;: &#39;#monitoring&#39;, &#39;username&#39;: &#39;webhookbot&#39;, &#39;text&#39;: &#39;This is posted to #monitoring and comes from a bot named webhookbot.&#39;, &#39;icon_emoji&#39;: &#39;:ghost:&#39;}&quot; https://hooks.slack.com/services/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
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="`+c+`" alt="è‡ªå®šä¹‰æ¶ˆæ¯" tabindex="0" loading="lazy"><figcaption>è‡ªå®šä¹‰æ¶ˆæ¯</figcaption></figure><h2 id="åœ¨alertmanagerä¸­ä½¿ç”¨slack" tabindex="-1"><a class="header-anchor" href="#åœ¨alertmanagerä¸­ä½¿ç”¨slack" aria-hidden="true">#</a> åœ¨Alertmanagerä¸­ä½¿ç”¨Slack</h2><p>åœ¨äº†è§£äº†Slackä»¥åŠIncomming Webhhookçš„åŸºæœ¬ä½¿ç”¨æ–¹å¼åï¼Œåœ¨Alertmanagerä¸­æ·»åŠ Slackæ”¯æŒå°±éå¸¸ç®€å•äº†ã€‚</p><p>åœ¨Alertmanagerçš„å…¨å±€é…ç½®ä¸­ï¼Œå°†Incomming Webhhookåœ°å€ä½œä¸ºslack_api_urlæ·»åŠ åˆ°å…¨å±€é…ç½®ä¸­å³å¯ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>global:
  slack_api_url: https://hooks.slack.com/services/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
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨æ¯ä¸ªreceiverä¸­å•ç‹¬å®šä¹‰è‡ªå·±çš„slack_configså³å¯ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>receiversï¼š
- name: slack
  slack_configs:
    - channel: &#39;#monitoring&#39;
      send_resolved: true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œå¦‚æœæˆ‘ä»¬æ‰‹åŠ¨æ‹‰é«˜å½“å‰ä¸»æœºçš„CPUåˆ©ç”¨ç‡ï¼Œåœ¨#Monitoringå¹³å°ä¸­ï¼Œæˆ‘ä»¬ä¼šæ¥æ”¶åˆ°ä¸€æ¡å‘Šè­¦ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="`+g+'" alt="å‘Šè­¦ä¿¡æ¯" tabindex="0" loading="lazy"><figcaption>å‘Šè­¦ä¿¡æ¯</figcaption></figure><p>è€Œå½“å‘Šè­¦é¡¹æ¢å¤æ­£å¸¸åï¼Œåˆ™å¯ä»¥æ¥æ”¶åˆ°å¦‚ä¸‹é€šçŸ¥ï¼š</p><figure><img src="'+m+`" alt="å‘Šè­¦æ¢å¤ä¿¡æ¯" tabindex="0" loading="lazy"><figcaption>å‘Šè­¦æ¢å¤ä¿¡æ¯</figcaption></figure><p>å¯¹äºIncomming Webhhookæ”¯æŒçš„å…¶å®ƒè‡ªå®šä¹‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥åœ¨slack_configä¸­è¿›è¡Œå®šä¹‰ï¼Œslack_configçš„ä¸»è¦é…ç½®å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>channel: &lt;tmpl_string&gt;
[ send_resolved: &lt;boolean&gt; | default = false ]
[ api_url: &lt;secret&gt; | default = global.slack_api_url ]
[ icon_emoji: &lt;tmpl_string&gt; ]
[ icon_url: &lt;tmpl_string&gt; ]
[ link_names: &lt;boolean&gt; | default = false ]
[ username: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.username&quot; . }}&#39; ]
[ color: &lt;tmpl_string&gt; | default = &#39;{{ if eq .Status &quot;firing&quot; }}danger{{ else }}good{{ end }}&#39; ]
[ footer: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.footer&quot; . }}&#39; ]
[ pretext: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.pretext&quot; . }}&#39; ]
[ text: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.text&quot; . }}&#39; ]
[ title: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.title&quot; . }}&#39; ]
[ title_link: &lt;tmpl_string&gt; | default = &#39;{{ template &quot;slack.default.titlelink&quot; . }}&#39; ]
[ image_url: &lt;tmpl_string&gt; ]
[ thumb_url: &lt;tmpl_string&gt; ]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¦è¦†ç›–é»˜è®¤çš„å‘Šè­¦å†…å®¹ï¼Œç›´æ¥ä½¿ç”¨Go Templateå³å¯ã€‚ä¾‹å¦‚ï¼š</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>color: &#39;{{ if eq .Status &quot;firing&quot; }}danger{{ else }}good{{ end }}&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,42),h=[p];function b(v,k){return t(),a("div",null,h)}const x=e(u,[["render",b],["__file","alert-with-slack.html.vue"]]);export{x as default};
